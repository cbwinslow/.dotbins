# dotbins Usage Guide

This guide explains how to work with the dotbins-managed tool collection contained in this repository. It covers the overall workflow, environment preparation, daily operations, and tips for customizing the setup for DevOps-focused tasks.

## 1. Repository Structure Overview

- `dotbins.yaml` – Declarative list of managed tools and platform-specific options.
- `linux/` & `macos/` – Platform folders that hold downloaded binaries organized by architecture.
- `shell/` – Shell integration scripts. Source these from your shell configuration to expose dotbins-managed binaries and helper functions.
- `configure-lfs-skip-smudge.py` – Helper script for configuring Git LFS in environments without automatic filtering.
- `USAGE_GUIDE.md` – This document, intended to be updated as the repository evolves.

## 2. Preparing Your Environment

1. **Clone or update this repository** in your home directory so `$HOME/.dotbins` matches the expected location.
2. **Install dotbins** if it is not already available:
   ```bash
   pipx install dotbins
   # or
   uv tool install dotbins
   ```
3. **Authenticate with GitHub** if you need to access private releases by exporting `GITHUB_TOKEN`.

## 3. Shell Integration

Source the shell integration script that matches your shell. This updates `PATH`, configures tool-specific aliases, and exposes helper functions defined in `shell/helpers.sh`.

```bash
# Bash
source "$HOME/.dotbins/shell/bash.sh"

# Zsh
source "$HOME/.dotbins/shell/zsh.sh"

# Fish
source "$HOME/.dotbins/shell/fish.fish"

# Nushell
source "$HOME/.dotbins/shell/nushell.nu"
```

> **Tip:** Add the appropriate `source` command to your shell's startup file (`~/.bashrc`, `~/.zshrc`, etc.) to enable the environment automatically.

## 4. Managing Tools with dotbins

### Sync All Tools
```bash
dotbins sync
```
Downloads or updates every tool defined in `dotbins.yaml` for all configured platforms.

### Sync Current Platform Only
```bash
dotbins sync --current
```
Useful for speed when you only need binaries for your current OS/architecture.

### Install or Refresh Specific Tools
```bash
dotbins sync terraform helm k9s
```
Targets individual tools that you want to refresh without touching the rest.

### Inspect Tool Status
```bash
dotbins status
```
Displays versions and download timestamps for every managed binary.

### Regenerate Documentation
```bash
dotbins readme
```
Rebuilds the autogenerated `README.md` with up-to-date tool information.

## 5. Helper Functions

Sourcing the shell scripts loads convenience functions defined in `shell/helpers.sh`:

- `dotbins_sync_all` – Wrapper for `dotbins sync` with logging.
- `dotbins_sync_current` – Wrapper for `dotbins sync --current`.
- `dotbins_install_tools <tool...>` – Sync only the named tools.
- `dotbins_tool_path <tool>` – Print the on-disk location of a managed binary.
- `dotbins_show_missing` – List configured tools that are not yet downloaded for the active platform.

These helpers provide consistent logging and validation, making it easier to run dotbins commands in scripts or CI pipelines.

## 6. Adding or Removing Tools

1. Edit `dotbins.yaml` and update the `tools` section.
2. Run `dotbins sync --current` to fetch binaries for your platform.
3. Commit the updated configuration and regenerated documentation if necessary.

When adding new tools, consult release assets to determine whether `binary_name` or `path_in_archive` must be specified so dotbins can extract the executable correctly.

## 7. DevOps-Focused Tooling

This repository now includes additional DevOps-oriented binaries such as Terraform, Helm, kubectl, Trivy, and k9s. Keep `dotbins.yaml` synchronized with the tools you rely on for infrastructure provisioning, Kubernetes operations, and security scanning.

## 8. Automation Tips

- **CI/CD pipelines** can call `dotbins_sync_current` to ensure required tools are present before running jobs.
- **Cron jobs** can periodically execute `dotbins_sync_all` to pick up new releases automatically.
- **Path inspection** using `dotbins_tool_path` helps debug PATH-related issues or configure other tooling to reference the managed binaries directly.

## 9. Troubleshooting

- Run `dotbins status --verbose` for detailed release metadata.
- Delete cached archives from `~/.cache/dotbins` if downloads become corrupted.
- Ensure executable permissions are preserved; dotbins handles this automatically, but custom scripts should verify with `chmod +x` when necessary.

## 10. Further Resources

- [dotbins GitHub repository](https://github.com/basnijholt/dotbins)
- [dotbins documentation](https://basnijholt.github.io/dotbins/)
- Tool-specific upstream documentation for advanced usage.

Keep this guide updated as you expand the repository with new workflows or automation helpers.
